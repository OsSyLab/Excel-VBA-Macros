# 📄 Excel PDF Reporting Macro (Filter + Export)

## 📘 Overview
This Excel VBA macro automatically exports your filtered report or visible data range as a **clean, top-aligned, and centered PDF report**.  
It is perfect for generating department summaries, HR logs, financial statements, or daily performance sheets — all with a single click.

Each file is automatically named and saved as:  
`Report_<Department>_<Date>.pdf`  
in your **Desktop → Reports** folder.

---

## ⚙️ Key Features

✅ One-click PDF export directly from Excel  
✅ Automatically creates the “Reports” folder on Desktop  
✅ Horizontally centered and top-aligned layout  
✅ Dynamic file naming using Department (cell B2) and date  
✅ Works perfectly with filtered data views  
✅ Opens the exported PDF immediately after saving  
✅ No manual file selection or dialog boxes required  

---

## 🧩 Components

| File | Description |
|------|--------------|
| `Export_PDF_Report.bas` | VBA module containing the macro |
| `Demo_Report.xlsm` | Example workbook with a pre-set button |
| `README.md` | Documentation file (this one) |

---

## 📄 Worksheet Structure

**Sheet Name:** `Report`

| Column | Header | Description |
|---------|---------|-------------|
| A | Date | Record date |
| B | Department | Group or department name |
| C | Employee | Employee name |
| D | Hours | Total worked hours |
| E | Status | Approval state |

---

### Example Data

| Date | Department | Employee | Hours | Status |
|------|-------------|-----------|--------|--------|
| 02/10/2025 | HR | Alice | 8 | Approved |
| 02/10/2025 | Finance | John | 7 | Pending |
| 03/10/2025 | IT | Sarah | 9 | Approved |
| 04/10/2025 | HR | Michael | 8 | Approved |

---

## 🧠 How It Works

1. Apply a filter on your table (e.g., select only “HR” department).  
2. Click the **“Export To PDF”** button on the worksheet.  
3. The macro automatically:
   - Reads the department name from cell **B2**  
   - Creates a folder `Desktop\Reports\` if not found  
   - Adjusts page layout for perfect alignment  
   - Exports the visible data to a PDF  
   - Opens the file immediately for review  
4. A message box confirms the export and shows the file path.

---

## 💡 Customization Options

| Option | Description |
|--------|--------------|
| Change output folder | Edit the path inside the `.bas` file |
| Change file name format | Modify the dynamic naming rule |
| Use landscape layout | Switch `.Orientation` to `xlLandscape` |
| Adjust margins | Edit `.TopMargin` / `.BottomMargin` values |
| Use another sheet | Replace `ActiveSheet` with a fixed sheet name |

---

## 🧩 VBA Source Code

The full VBA implementation is available in the file  
**`Export_PDF_Report.bas`** within this repository.  
You can import it directly into Excel:  
**Alt + F11 → File → Import File → Select `.bas` file**

---

## ⚙️ Troubleshooting

| Issue | Cause | Solution |
|--------|--------|-----------|
| “Subscript out of range” | Sheet name not found | Rename sheet to “Report” or use `ActiveSheet` |
| PDF alignment looks off | Wrong margin or center settings | Adjust in `.bas` file PageSetup section |
| File not opening | PDF viewer blocked by Excel | Disable preview restrictions in Excel Trust Center |
| Folder not created | User permission issue | Create manually on Desktop if needed |

---

## 🧭 Recommended Use Cases
- HR and department summary reports  
- Project performance exports  
- Filtered task or timesheet PDFs  
- Daily or weekly report automation  

---

## 🧾 Example Output
**File name:**  
Report_HR_2025-10-15.pdf

arduino

**File path:**  
C:\Users<username>\Desktop\Reports\



---

License

**MIT License**  
You are free to use, modify, and distribute this code with attribution.  

© 2025 **Data Solutions Lab. by Osman Uluhan** – All rights reserved.
